"use strict";var renderFilms,genres,inputValue,pageNumber=1,form=document.querySelector(".homePage__form"),input=document.querySelector(".homePage__input"),prevBtn=document.querySelector(".js-prev"),nextBtn=document.querySelector(".js-next"),homePlaginationNumber=document.querySelector(".homepage__page"),list=document.querySelector(".homePage__filmList"),popWhenError=document.querySelector(".homePage__error");function fetchGenres(){fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=f1943ebda4bde31f3353b960641d381f&language=en-US").then(function(e){return e.json()}).then(function(e){genres=e.genres}).catch(function(e){return console.log(e)})}function createCards(e,t,a,n){var r=document.createElement("li");r.classList.add("homePage__filmItem");var o=document.createElement("img");o.classList.add("homePage__img"),o.setAttribute("src","https:/image.tmdb.org/t/p/w500".concat(t));var i=document.createElement("p");i.classList.add("homePage__movieName");var c=getYearFromDate(a);return i.textContent="".concat(e," (").concat(c,")"),r.append(o,i),r}function getYearFromDate(e){return e.slice(0,4)}function getPopularMovies(){var t=document.createDocumentFragment();list.innerHTML="",fetch("https://api.themoviedb.org/3/movie/popular?api_key=f1943ebda4bde31f3353b960641d381f&language=en-US&page=".concat(pageNumber)).then(function(e){return e.json()}).then(function(e){console.log(e),e.results.forEach(function(e){t.append(createCards(e.title,e.backdrop_path,e.release_date,e.id))}),list.append(t),renderFilms=e.results})}function searchFilms(e){e.preventDefault(),inputValue=input.value,fetchMovies(),form.reset()}function fetchMovies(){var t=document.createDocumentFragment();list.innerHTML="",fetch("https://api.themoviedb.org/3/search/movie?api_key=f1943ebda4bde31f3353b960641d381f&language=en-US&page=".concat(pageNumber,"&include_adult=false&query=").concat(inputValue)).then(function(e){return e.json()}).then(function(e){e.results.length<1?popWhenError.classList.remove("main__hidden"):popWhenError.classList.add("main__hidden"),console.log(e),e.results.forEach(function(e){console.log(createCards(e.title,e.backdrop_path,e.id)),t.append(createCards(e.title,e.backdrop_path,e.id))}),list.append(t),renderFilms=e.results}).catch(function(e){return console.log(e)})}function plaginationNavigation(e){Number(homePlaginationNumber.textContent);"Next"===e.target.textContent&&(pageNumber+=1,homePlaginationNumber.textContent=pageNumber),"Prev"===e.target.textContent&&(pageNumber-=1,homePlaginationNumber.textContent=pageNumber),"1"===homePlaginationNumber.textContent?prevBtn.classList.add("transparent"):prevBtn.classList.remove("transparent"),homePlaginationNumber.textContent<=1&&(prevBtn.disabled=!0),console.log(pageNumber)}function pageAfterLoading(){"1"===homePlaginationNumber.textContent&&prevBtn.classList.add("transparent")}fetchGenres(),getPopularMovies(),window.onload=pageAfterLoading,prevBtn.addEventListener("click",plaginationNavigation),prevBtn.addEventListener("click",getPopularMovies),nextBtn.addEventListener("click",plaginationNavigation),nextBtn.addEventListener("click",getPopularMovies),form.addEventListener("submit",searchFilms);var homePageBtn=document.querySelector("#homePage-js"),myLibraryPageBtn=document.querySelector("#myLibraryPage-js"),detailsPageShown=document.querySelector(".detalisPage__block"),myLibraryPageShown=document.querySelector("#myFilmLibraryPage__block"),homePageShown=document.querySelector(".homePage__block"),selectFilm={};function showHomePage(){myLibraryPageShown.classList.add("main__hidden"),detailsPageShown.classList.add("main__hidden"),homePageShown.style.display="block",homePageBtn.classList.add("nav-list__item-hover"),myLibraryPageBtn.classList.remove("nav-list__item-hover")}function showLibraryPage(){homePageShown.classList.add("main__hidden"),detailsPageShown.classList.add("main__hidden"),myLibraryPageShown.classList.remove("main__hidden"),myLibraryPageBtn.classList.add("nav-bar__link-hover"),homePageBtn.classList.remove("nav-bar__link-hover")}window.onload=showHomePage(),homePageBtn.addEventListener("click",showHomePage),myLibraryPageBtn.addEventListener("click",showLibraryPage);var cardLibrary=document.querySelector(".library-list"),buttonWatch=document.querySelector(".library__btn--watch"),buttonQueue=document.querySelector(".library__btn--queue");buttonWatch.addEventListener("click",drawWatchedFilmList),buttonQueue.addEventListener("click",drawQueueFilmList);var settings=[{poster_path:"dark",title:"cvjfsdkjg",id:1,vote_average:7.5},{poster_path:"fgdf",title:"fgfdg",id:4,vote_average:56}];function drawWatchedFilmList(e){"BUTTON"==e.target.nodeName&&JSON.parse(localStorage.getItem("settings")).forEach(function(e){return createLibraryCardFunc(e.poster_path,e.title,e.id,e.vote_average)})}function drawQueueFilmList(e){(buttonWatch.classList.remove("library__btn--active"),buttonQueue.classList.add("library__btn--active"),"BUTTON"==e.target.nodeName)&&JSON.parse(localStorage.getItem("filmsQueue")).forEach(function(e){return createLibraryCardFunc(e.poster_path,e.title,e.id,e.vote_average)})}function createLibraryCardFunc(e,t,a,n){var r=document.createElement("li");r.classList.add("library__list-item"),cardLibrary.append(r);var o=document.createElement("img");o.setAttribute("src","https://image.tmdb.org/t/p/w500".concat(e)),o.setAttribute("alt","poster film"),r.append(o);var i=document.createElement("p");i.classList.add("library__vote"),i.textContent=n,r.append(i);var c=document.createElement("p");c.classList.add("library__nameFilm"),r.append(c),c.textContent=t,console.log(cardLibrary)}localStorage.setItem("settings",JSON.stringify(settings));